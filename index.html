<!DOCTYPE html>
<html>
<head>
    <title>EmoSculpt: The Emotional Gym</title>
    <style>
        body {
            background-color: #1F1F1F;
            color: #FFFFFF;
            font-family: 'Roboto Mono', monospace;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2vh; /* Base font size relative to screen height */
        }

        #chat-container {
            background-color: #2B2B2B;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0px 2px 5px rgba(255, 255, 255, 0.1);
            width: 100%;
            height: 90vh; /* Reduced height for better visibility on mobile */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-weight: 500;
        }

        /* Logo Styles */
        .logo {
            display: block; 
            max-width: 12vw; /* Scales with the viewport width */
            margin: 0 auto 10px; 
        }

        #chat-history {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #404040;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .user-message, 
        .bot-message {
            padding: 2vh; /* Padding relative to screen height */
            margin-bottom: 1vh;
            border-radius: 8px;
            line-height: 1.6;
            display: flex;
            align-items: center; /* Center the loader and text vertically */
        }

        .user-message {
            text-align: right;
            background-color: #424242; 
        }

        .bot-message {
            text-align: left;
            background-color: #333333;
        }

        .loader {
            width: 1.5em; /* Smaller loader size */
            height: 1.5em; /* Smaller loader size */
            margin-right: 10px; /* Space between loader and text */
            display: none; /* Initially hidden */
        }

        form {
            display: flex;
            position: relative; /* Ensure form is positioned relative to the container */
        }

        input {
            flex-grow: 1;
            margin-right: 10px;
            padding: 1.5vh;
            border: 1px solid #505050;
            border-radius: 5px;
            background-color: #333333;
            color: #FFFFFF;
            font-size: 2vh;
        }

        button {
            background-color: #673AB7;
            color: white;
            border: none;
            padding: 1.5vh 2vh;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            font-size: 2vh;
        }

        /* Responsive text size based on screen width */
        @media (max-width: 768px) {
            body {
                font-size: 1.8vh;
            }

            #chat-container {
                padding: 15px;
                height: 85vh; /* Reduce height on smaller screens */
            }

            button {
                padding: 1.2vh 1.5vh;
            }

            .logo {
                max-width: 15vw; /* Adjust logo size for smaller screens */
            }
        }

        @media (max-width: 480px) {
            body {
                font-size: 1.6vh;
            }

            #chat-container {
                padding: 10px;
                height: 80vh; /* Further reduce height on small screens */
            }

            input {
                padding: 2vh; /* Increase padding for input */
            }

            button {
                padding: 1.5vh 2vh;
            }

            .logo {
                max-width: 20vw; /* Further adjust logo size for smaller screens */
            }
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <img src="https://i.ibb.co/L6PTKgm/Emo-Sculpt.jpg" alt="EmoSculpt Logo" class="logo">
        <div id="chat-history"></div>
        <form id="chat-form">
            <input type="text" id="user-input" placeholder="Enter your message">
            <button type="submit">Send</button>
        </form>
    </div>
    <script>
        const chatHistory = document.getElementById('chat-history');
        const userInput = document.getElementById('user-input');
        const form = document.getElementById('chat-form');

        // Welcome message to be displayed in the chat window
        const welcomeMessage = `Hello! I'm EmoSculpt, your personal trainer for emotional strength. I'm based on the groundbreaking research of neuroscientist Richard J. Davidson, as detailed in his book The Emotional Life of Your Brain.

Just like physical fitness, your emotional well-being depends on building up your inner strengths. Davidson's work reveals that we all have our own unique emotional styles, which describes how we deal with our emotions. It is shaped by six key dimensions:

Resilience: How quickly you bounce back from setbacks.
Outlook: Your tendency towards optimism or pessimism.
Social Intuition: Your ability to read social cues.
Self-Awareness: How well you understand your own emotions.
Sensitivity to Context: How well you adapt your emotions to different situations.
Attention: Your ability to focus and concentrate.

These dimensions influence how we respond to stress, connect with others, and experience the world.`;

        // Function to display the welcome message
        function displayWelcomeMessage() {
            const messageElement = document.createElement('div');
            messageElement.classList.add('bot-message');
            messageElement.textContent = welcomeMessage;

            chatHistory.appendChild(messageElement);
            chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the bottom
        }

        async function sendMessage() {
            const userMessage = userInput.value;
            userInput.value = ''; // Clear input field
            try {
                // Show the loader
                const botMessageElement = document.createElement('div');
                botMessageElement.classList.add('bot-message');

                const loader = document.createElement('img');
                loader.src = 'loader.gif'; // Use the local loader.gif
                loader.classList.add('loader');
                loader.style.display = 'inline-block'; // Show loader

                botMessageElement.appendChild(loader);
                botMessageElement.appendChild(document.createTextNode("...")); // Placeholder text while loading
                chatHistory.appendChild(botMessageElement);
                chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the bottom

                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ userInput: userMessage }),
                });

                const data = await response.json();
                const botMessage = data.response;

                // Replace the placeholder text with the actual bot message
                botMessageElement.textContent = ""; // Clear the loader
                botMessageElement.appendChild(loader); // Keep the loader
                botMessageElement.appendChild(document.createTextNode(botMessage)); // Append the actual message

                chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the bottom
            } catch (error) {
                console.error('Error:', error);
            }
        }

        form.addEventListener('submit', (event) => {
            event.preventDefault(); // Prevent form submission
            sendMessage();
        });

        // Call the displayWelcomeMessage function when the page loads
        window.addEventListener('load', displayWelcomeMessage);
    </script>
</body>
</html>
