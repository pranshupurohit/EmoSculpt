<!DOCTYPE html>
<html>
<head>
    <title>EmoSculpt: The Emotional Gym</title>
    <style>
        /* ... (existing CSS styles) ... */
    </style>
</head>
<body>
    <div id="chat-container">
        <img src="https://i.ibb.co/L6PTKgm/Emo-Sculpt.jpg" alt="EmoSculpt Logo" class="logo">
        <div id="chat-history"></div>
        <form id="chat-form">
            <input type="text" id="user-input" placeholder="Enter your message">
            <button type="submit">Send</button>
        </form>
    </div>
    <script>
        const chatHistory = document.getElementById('chat-history');
        const userInput = document.getElementById('user-input');
        const form = document.getElementById('chat-form');

        // Welcome message to be displayed in the chat window
        const welcomeMessage = `Hello! I'm EmoSculpt, your personal trainer for emotional strength. I'm based on the groundbreaking research of neuroscientist Richard J. Davidson, as detailed in his book The Emotional Life of Your Brain.

Just like physical fitness, your emotional well-being depends on building up your inner strengths. Davidson's work reveals that we all have our own unique emotional styles, which describes how we deal with our emotions. It is shaped by six key dimensions:

Resilience: How quickly you bounce back from setbacks.
Outlook: Your tendency towards optimism or pessimism.
Social Intuition: Your ability to read social cues.
Self-Awareness: How well you understand your own emotions.
Sensitivity to Context: How well you adapt your emotions to different situations.
Attention: Your ability to focus and concentrate.

These dimensions influence how we respond to stress, connect with others, and experience the world.`;

        // Function to display the welcome message
        function displayWelcomeMessage() {
            const messageElement = document.createElement('div');
            messageElement.classList.add('bot-message');
            messageElement.textContent = welcomeMessage;

            chatHistory.appendChild(messageElement);
            chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the bottom
        }

        async function sendMessage() {
            const userMessage = userInput.value;
            userInput.value = ''; // Clear input field
            try {
                // Show the loader
                const botMessageElement = document.createElement('div');
                botMessageElement.classList.add('bot-message');

                const loader = document.createElement('img');
                loader.src = 'loader.gif'; // Use the local loader.gif
                loader.classList.add('loader');
                loader.style.display = 'inline-block'; // Show loader

                botMessageElement.appendChild(loader);
                botMessageElement.appendChild(document.createTextNode("...")); // Placeholder text while loading
                chatHistory.innerHTML = ""; // Clear previous messages
                chatHistory.appendChild(botMessageElement);
                chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the bottom

                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ userInput: userMessage }),
                });

                const data = await response.json();
                const botMessage = data.response;

                // Replace the placeholder text with the actual bot message
                botMessageElement.textContent = ""; // Clear the loader
                botMessageElement.appendChild(loader); // Keep the loader
                botMessageElement.appendChild(document.createTextNode(botMessage)); // Append the actual message

                chatHistory.scrollTop = chatHistory.scrollHeight; // Scroll to the bottom
            } catch (error) {
                console.error('Error:', error);
            }
        }

        form.addEventListener('submit', (event) => {
            event.preventDefault(); // Prevent form submission
            sendMessage();
        });

        // Call the displayWelcomeMessage function when the page loads
        window.addEventListener('load', displayWelcomeMessage);
    </script>
</body>
</html>
